# This is a sample config file for tgt-admin.
# By default, tgt-admin looks for its config file in /etc/tgt/targets.conf

# This one includes other config files:

include /etc/tgt/temp/*.conf


# Set the driver. If not specified, defaults to "iscsi".

default-driver iscsi


# Sample target with one LUN only. Defaults to allow access for all initiators:

<target iqn.2008-09.com.example:server.target1>
    backing-store /dev/LVM/somedevice
</target>


# Similar, but we use "direct-store" instead of "backing-store".
# "direct-store" reads drive parameters with sg_inq command and sets them to
# the target.
# Parameters fatched with sg_inq are:
# - Vendor identification
# - Product identification
# - Product revision level
# - Unit serial number (if present)
# We also specify "incominguser".

<target iqn.2008-09.com.example:server.target2>
    direct-store /dev/sdd
    incominguser someuser secretpass12
</target>


# An example with multiple LUNs, disabled write-cache (tgtd enables write-cache
# by default) and vendor identification set to "MyVendor"

<target iqn.2008-09.com.example:server.target3>
    backing-store /dev/LVM/somedevice1	# Becomes LUN 1
    backing-store /dev/LVM/somedevice2	# Becomes LUN 2
    backing-store /dev/LVM/somedevice3	# Becomes LUN 3
    write-cache off
    vendor_id MyCompany Inc.
</target>


# Similar to the one above, but we fetch vendor_id, product_id, product_rev and
# scsi_sn from the disks.
# Vendor identification (vendor_id) is replaced in all disks by "MyVendor"

<target iqn.2008-09.com.example:server.target4>
    direct-store /dev/sdb	# Becomes LUN 1
    direct-store /dev/sdc	# Becomes LUN 2
    direct-store /dev/sdd	# Becomes LUN 3
    write-cache off
    vendor_id MyCompany Inc.
</target>


# Note that "first-device-first-lun numbering" will work only for simple
# scenarios above, where _only_ direct-store _or_ backing-store is used.
# If you mix backing-store and direct-store, then all backing-store entries
# are processed before direct-store-entries.

<target iqn.2008-09.com.example:server.target4>
    direct-store /dev/sdb	# Becomes LUN 3
    backing-store /dev/sdc	# Becomes LUN 1
    direct-store /dev/sdd	# Becomes LUN 4
    backing-store /dev/sde	# Becomes LUN 2
</target>


# Even more complicated example - each device has different parameters.
# You can use indentation to make the config file more readable.
# Note that LUNs will be assigned more or less randomly here (and still
# backing-store get LUNs assigned before drect-store).
# You can specify multiple mode_page parameters (they are commented out
# in this example).
# Note that some parameters (write-cache, scsi_sn) were specified "globally".
# "Global" parameters will be applied to all LUNs; they can be overwritten
# "locally", per LUN.
#

<target iqn.2008-09.com.example:server.target5>

    <direct-store /dev/sdd>
	vendor_id VENDOR1
	removable 1
	# lun 1		# Not yet supported
    </direct-store>

    <direct-store /dev/sda>
	vendor_id VENDOR2
	# lun 2		# Not yet supported
    </direct-store>

    <backing-store /dev/sdb1>
	vendor_id back1
	scsi_sn SERIAL
	write-cache on
	# lun 3		# Not yet supported
    </backing-store>

    <backing-store /dev/sdd1>
	vendor_id back2
	#mode_page 8:0:18:0x10:0:0xff....
	#mode_page 8:0:18:0x10:0:0xff....
	# lun 4		# Not yet supported
    </backing-store>

    # Some more parameters which can be specified locally or globally:
    #scsi_id ...
    #scsi_sn ...
    #vendor_id ...
    #product_id ...
    #product_rev ...
    #sense_format ...
    #removable ...
    #online ...
    #path ...
    #mode_page 8:0:18:0x10:0:0xff....
    #mode_page 8:0:18:0x10:0:0xff....

    write-cache off
    scsi_sn multipath-10

    # Parameters below are global. They can't be configured per LUN.
    # Only allow connections from 192.168.100.1 and 192.168.200.5
    initiator-address 192.168.100.1
    initiator-address 192.168.200.5

    # Allowed incoming users
    incominguser user1 secretpass12
    incominguser user2 secretpass23

    # Outgoing user
    outgoinguser userA secretpassA

</target>



# Not supported configurations, and therefore, commented out:

#<target iqn.2008-09.com.example:server.target6>
#    <direct-store /dev/sdd>
#        vendor_id VENDOR1
#    </direct-store>
#
#    direct-store /dev/sdc
#</target>

# This one will break the parser:

#<target iqn.2008-09.com.example:server.target7>
#    <direct-store /dev/sdd>
#        vendor_id VENDOR1
#    </direct-store>
#
#    direct-store /dev/sdc
#
#    <direct-store /dev/sdd>
#        vendor_id VENDOR1
#    </direct-store>
#</target>
